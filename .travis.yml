language: python
python:
- '3.5'
install:
- pip install -r requirements.txt
- pip install braintree coveralls mock mysqlclient
env:
- DB=sqlite
- DB=postgres
addons:
  postgresql: '9.4'
before_script:
- psql -c 'CREATE DATABASE hc;' -U postgres
script:
- python manage.py makemigrations
- python manage.py migrate
- python manage.py collectstatic --noinput
- coverage run --omit=*/tests/* --source=hc manage.py test
after_success: coveralls
cache: pip
deploy:
  provider: heroku
  api_key:
    secure: vj/h0TofypN/aT4zgP2HHfww8HRgs0y42XIs2OJ/kA5zhMszfNDYFWFctfMc6OXboNFJ3uagAkJ1S7N+M2B5jDHwUMoc11Zm/n/fsToYWn1pW+zD3Xy9bSW4dS/MPDoIroYQVesyrtvFAdxdd6sqCFBvjRiDRKvZsOu0lc3l4Ya6WcHgrKudYAIIFKyRx4PrmMEJ/ESlGnHn1M5MBr8vE73uVFzUSt1+nTAweP+XdKWymTbSYd1OxVgvedue5XAYmiCCbbio0T1HVL+MqaQIBFwrUI/0oGxGEy5Ys4GESitb6rtaawYhDbyL+7ow5FDcg0g5T0nUbsb54Y65LHl8OjWIBLD97K3W1zI3eJwXexiKZeCMLYCARg3ueg5SxZkpcbXqHaNcvGUwsAui8bblpVB0UstxxjCQRuLSyN0rI0lhccpmCbJetPnqA2FKH4PK1lAHZImIrEChz9rDUbeGOytZ/+n1PwCZM01jW/F1FHLAESdNOqGrhFeQSipOQYPTIjr77JTqMFyY33/G5ZmW5suZ9vQT8A8dak2vgETmonT2VbuQIsyn4f33EC75uct/rybMZpOvvvVjzM/+M75Jp0XEEEh5wzBU4P0DesM0YgjBVU+gO1P6bEMvmi63PbBbWXSeggLCRDflgMebqMSg5FTi7msUfaDqf6LQmmbUYSU=
  app: stark-healthchecks
  on:
    repo: clementm916/healthchecks_stark
    branch: heroku-setup
